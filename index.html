<!DOCTYPE html>
<html>
<head>
    <!--Script for getting plotly.js in-->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> 

    <!--Leaflet stylesheet and leaflet script-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>    

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>

</head>

<body>

    <div id="thevizcolumn" style="width:80%; height:400px; float: left; background-color:rgb(255, 255, 255);">
        <p>Cholera</p>
        <div style="width:50%; height:400px; float: left">
        <div id="c_plot" style="width:100%;height:300px;" ></div>
        </div>
    </div>


    <script>
   
    Plotly.d3.tsv("./choleraDeaths.tsv", function(err, rows) {

    function unpack(rows, key) {
        return rows.map(function(row) { return row[key]; });
    }

    var headerNames = Plotly.d3.keys(rows[0]);

    var headerValues = [];
    var cellValues = [];
    for (i = 0; i < 4; i++) {
        headerValue = [headerNames[i]];
        headerValues[i] = headerValue;
        cellValue = unpack(rows, headerNames[i]);
        cellValues[i] = cellValue;
    }

    for (j = 0; j < 42; j++) {
        cellValues[3][j] = parseInt(cellValues[1][j]) + parseInt(cellValues[2][j]);
    }


    headerValues[3] ="Total Attacks and Deaths per Day";


    // clean dates
    for (i = 0; i < cellValues[1].length; i++) {
        var dateValue = cellValues[1][i].split(' ')[0]
        cellValues[1][i] = dateValue
    }
    

    var data = [{
    type: 'table',
    columnorder: [0,1,2,3],
    columnwidth: [200,500,500,500],
    header: {
    values: headerValues,
    align: "center",
    line: {width: 1, color: 'rgb(50, 50, 50)'},
    fill: {color: ['rgb(255, 255, 255)']},
    font: {family: "Arial", size: 8, color: ["black"]}
    },
    cells: {
    values: cellValues,
    align: ["center", "center", "center"],
    line: {color: "black", width: 1},
    fill: {color: ['rgb(102, 219, 240)','rgb(240, 102, 219)', 'rgb(220, 240, 100)', 'rgb(240, 157, 102)' ]},
    font: {family: "Arial", size: 8, color: ["black"]}
    }
    }]

    var layout = {
    title: "Cholera Deaths"
    }

    Plotly.newPlot('c_plot', data, layout);
    });

</script>
</body>
</html>